<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Tambah Transaksi</title>
  <link rel="stylesheet" href="../css/bootstrap.min.css" />
  <link rel="stylesheet" href="../fontawesome/all.min.css" />
</head>
<body>
  <div class="container mt-4">
    <h3 class="mb-4 fw-bold">Tambah Transaksi</h3>
    <form action="../backend/insert_transaksi.php" method="POST">
      <div class="mb-3">
        <label for="tanggal" class="form-label">Tanggal</label>
        <input type="date" class="form-control" id="tanggal" name="tanggal" required />
      </div>

      <div class="mb-3">
        <label for="id_customer" class="form-label">Customer</label>
        <select class="form-select" id="id_customer" name="id_customer" required>
          <option value="">-- Pilih Customer --</option>
        </select>
      </div>

      <div class="mb-3">
        <label for="id_item" class="form-label">Item</label>
        <select class="form-select" id="id_item" name="id_item" required>
          <option value="">-- Pilih Item --</option>
        </select>
      </div>

      <div class="mb-3">
        <label for="jumlah" class="form-label">Jumlah</label>
        <input type="number" class="form-control" id="jumlah" name="jumlah" min="1" required />
      </div>

      <div class="mb-3">
        <label for="harga" class="form-label">Harga per Item</label>
        <input
          type="number"
          class="form-control"
          id="harga"
          name="harga"
          min="0"
          required
          placeholder="Masukkan harga per item"
        />
      </div>

      <div class="mb-3">
        <label for="total" class="form-label">Total</label>
        <input type="number" class="form-control" id="total" name="total" readonly />
      </div>

      <div class="mb-3">
        <label for="id_sales" class="form-label">Sales</label>
        <select class="form-select" id="id_sales" name="id_sales" required>
          <option value="">-- Pilih Sales --</option>
        </select>
      </div>

      <button type="submit" class="btn btn-success">Simpan</button>
      <a href="transaksi.html" class="btn btn-secondary">Kembali</a>
    </form>
  </div>

  <script>
    // Ambil data customer dari backend
    fetch('../backend/get_customer.php')
      .then((res) => res.json())
      .then((data) => {
        const select = document.getElementById('id_customer');
        data.forEach((c) => {
          select.innerHTML += `<option value="${c.id_customer}">${c.nama_customer}</option>`;
        });
      });

    // Ambil data item dari backend
    fetch('../backend/get_item.php')
      .then((res) => res.json())
      .then((data) => {
        const select = document.getElementById('id_item');
        data.forEach((i) => {
          select.innerHTML += `<option value="${i.id_item}">${i.nama_item}</option>`;
        });
      });

    // Ambil data sales dari backend
    fetch('../backend/get_sales.php')
      .then((res) => res.json())
      .then((data) => {
        const select = document.getElementById('id_sales');
        data.forEach((s) => {
          select.innerHTML += `<option value="${s.id_sales}">${s.nama_sales}</option>`;
        });
      });

    // Hitung total otomatis berdasarkan input jumlah dan harga
    const jumlahInput = document.getElementById('jumlah');
    const hargaInput = document.getElementById('harga');
    const totalInput = document.getElementById('total');

    function hitungTotal() {
      const jumlah = parseInt(jumlahInput.value) || 0;
      const harga = parseInt(hargaInput.value) || 0;
      totalInput.value = jumlah * harga;
    }

    jumlahInput.addEventListener('input', hitungTotal);
    hargaInput.addEventListener('input', hitungTotal);
  </script>
</body>
</html>
